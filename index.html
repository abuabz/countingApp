<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Timer + Clock</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            color: #fff;
            font-family: "Science Gothic", sans-serif;
            overflow: hidden;
            user-select: none;
        }

        #display {
            font-size: 130px;
            letter-spacing: 6px;
            font-weight: 500;
            white-space: nowrap;
            line-height: 1.2;
            text-align: center;
        }

        @media (max-width: 768px) {
            #display {
                font-size: 82px;
                letter-spacing: 4px;
                transform: rotate(90deg);
            }
        }

        .flash { animation: flash 0.5s infinite alternate; }
        @keyframes flash { from { background: #ff0000; } to { background: #000; } }

        #settingsBtn {
            position: fixed;
            right: 28px;
            bottom: 28px;
            width: 60px;
            height: 60px;
            background: rgba(255, 0, 0, 0.12);
            border: 2px solid #ff00002b;
            border-radius: 50%;
            font-size: 32px;
            color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(12px);
            z-index: 1000;
            transition: all 0.3s;
        }
        #settingsBtn:hover { background: #ff000024; }

        :fullscreen #settingsBtn,
        :-webkit-full-screen #settingsBtn { opacity: 0; visibility: hidden; pointer-events: none; }

        #modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(12px);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 999;
        }
        #modal.open { opacity: 1; visibility: visible; }

        .modal-content {
            background: rgba(20,20,30,0.97);
            padding: 40px 30px;
            border-radius: 20px;
            border: 1px solid #ff0000;
            text-align: center;
            min-width: 340px;
            box-shadow: 0 0 40px rgba(255,0,0,0.3);
        }

        input, button {
            margin: 10px;
            padding: 14px 20px;
            border: none;
            border-radius: 50px;
            font-size: 17px;
            font-weight: bold;
        }
        input { background: rgba(255,255,255,0.1); color: white; }
        #startTimer { background: #00ff2a4e; color: #000; cursor: pointer; }
        #startTimer:hover { background: white; }
        #showClock { background: transparent; color: #ffffff; border: 1px solid #ffffff; cursor: pointer; }
        #showClock:hover { background: #ffffff5e; color: #ffffff; }
        #closeModal { position: absolute; top: 12px; right: 18px; background: none; border: none; font-size: 32px; color: #666; cursor: pointer; }

        #stopBtn {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            padding: 18px 60px;
            background: red;
            color: white;
            font-size: 28px;
            font-weight: bold;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            z-index: 1001;
            display: none;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Science+Gothic:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>

    <h1 id="display">00:00:00</h1>

    <!-- Settings Gear Icon -->
    <div id="settingsBtn">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"/>
            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"/>
        </svg>
    </div>

    <!-- Modal -->
    <div id="modal">
        <div class="modal-content">
            <button id="closeModal">Ã—</button>
            <h2>Set Timer</h2>
            <input type="date" id="dateSelect">
            <input type="time" id="timeSelect">
            <br>
            <button id="startTimer">START TIMER</button>
            <br><br>
            <button id="showClock">SHOW CURRENT TIME (AM/PM)</button>
        </div>
    </div>

    <button id="stopBtn">STOP ALARM</button>

    <!-- Alarm Sound -->
    <audio id="alarmSound" loop preload="auto">
        <source src="aaramsound.mp3" type="audio/mpeg">
        Your browser does not support audio.
    </audio>

    <script>
        const display = document.getElementById("display");
        const settingsBtn = document.getElementById("settingsBtn");
        const modal = document.getElementById("modal");
        const closeModal = document.getElementById("closeModal");
        const startTimer = document.getElementById("startTimer");
        const showClock = document.getElementById("showClock");
        const stopBtn = document.getElementById("stopBtn");
        const alarm = document.getElementById("alarmSound");

        let targetTime = null;
        let alarmPlayed = false;
        let isClockMode = false;
        let lastText = "";
        let userInteracted = false;

        // Unlock audio on first user interaction
        const unlockAudio = () => {
            if (!userInteracted) {
                alarm.play().then(() => alarm.pause()).catch(() => {});
                userInteracted = true;
                document.removeEventListener("click", unlockAudio);
                document.removeEventListener("touchstart", unlockAudio);
            }
        };
        document.addEventListener("click", unlockAudio);
        document.addEventListener("touchstart", unlockAudio);

        // Modal controls
        settingsBtn.onclick = () => { unlockAudio(); modal.classList.add("open"); };
        closeModal.onclick = () => modal.classList.remove("open");
        modal.onclick = (e) => { if (e.target === modal) modal.classList.remove("open"); };

        startTimer.onclick = () => {
            const date = document.getElementById("dateSelect").value;
            const time = document.getElementById("timeSelect").value;
            if (!date || !time) return alert("Select date & time");
            const [h, m] = time.split(":").map(Number);
            targetTime = new Date(date);
            targetTime.setHours(h, m, 0, 0);
            isClockMode = false;
            modal.classList.remove("open");
        };

        showClock.onclick = () => {
            isClockMode = true;
            targetTime = null;
            alarmPlayed = false;
            document.body.classList.remove("flash");
            stopBtn.style.display = "none";
            alarm.pause();
            alarm.currentTime = 0;
            modal.classList.remove("open");
        };

        stopBtn.onclick = () => {
            alarm.pause();
            alarm.currentTime = 0;
            location.reload();
        };

        function update() {
            const now = new Date();
            let text = "";

            if (isClockMode) {
                text = now.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: true
                });
            } else if (!targetTime) {
                text = "00:00:00";
            } else {
                const diff = targetTime - now;
                if (diff <= 0) {
                    text = "TIME UP!";
                    if (!alarmPlayed && userInteracted) {
                        alarm.currentTime = 0;
                        alarm.play().catch(() => {});
                        alarmPlayed = true;
                        document.body.classList.add("flash");
                        stopBtn.style.display = "block";
                    }
                } else {
                    const h = Math.floor(diff / (1000*60*60));
                    const m = Math.floor((diff % (1000*60*60)) / (1000*60));
                    const s = Math.floor((diff % (1000*60)) / 1000);
                    text = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
                }
            }

            if (text !== lastText) {
                display.textContent = text;
                lastText = text;
            }
        }

        setInterval(update, 1000);
        update();

        document.addEventListener("dblclick", () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        });
    </script>
</body>
</html>
